---
title: "MLPRCNDC"
author: "Connor Simpson"
date: "12/02/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```




```{r}
crossvalidtest <- function(ts,exog,k,h){
  pred = data.frame(ts)
  tru = data.frame(ts)
  testa = data.frame(matrix(data=NA,nrow=length(ts),ncol = k))
  traina = data.frame(matrix(data=NA,nrow=length(ts),ncol = k))
  arsq=0
  WMAPE=0
  rmse=0
  reler=0
  v = as.integer(length(ts)/(2*k))
  size = 2*v
  error = rep(NA,(k-1))
  for (i in (0:(k-1))){
    if (i == 0){z = 0}
    else{z=1}
      if (i == k-1){z2 = 0}
    else{z2=1}
    test = rep(NA,length(ts))
    testx = data.frame(exog)
    for (bb in (1:length(exog))){
      testx[bb] = c(rep(NA,length(exog[,bb])))
    }
    train = ts
    trainx = exog
    test[((size)*i+1):((size)*i+size)] = ts[((size)*i+1):((size)*i+size)]
    for (m in (1:length(testx))){
      testx[((size)*i+1):((size)*i+size),m] = exog[((size)*i+1):((size)*i+size),m]
    }
    train[((size)*i+1-h*z):((size)*i+size+h*z2)] = NA
    for (b in (1:length(trainx))){
      trainx[((size)*i+1-h*z):((size)*i+size+h*z2),b] = NA
    }
    #mod = Arima(train,order = order,xreg = trainx,include.constant = F)
    #modt = Arima(test,model = mod,xreg=testx,include.constant = F)
    #error[i+1] = accuracy(modt)[2]
    #coefnum = sum(order)
    #pred1 = modt$fitted
    #tru1 = test
    #print(length(tsori))
    #print(length(pred1))
    #print(length(tru1))
    #pred = antidiff(tsori,pred1)
    #tru = antidiff(tsori,tru1)
    
    
    
    #plot.ts(pred,col=2)
    #plot.ts(tru,col=4)
    #plot.ts(tru-pred)
    #print(sum(abs(tru),na.rm=T))
    #print(sum(abs(tru-pred),na.rm=T))
    #arsq[i+1] = adjr(pred,tru,coefnum)
    #WMAPE[i+1] = WMAPE(pred,tru)
    #rmse[i+1] = rootMSE(tru,pred)
    #bench = tru[-length(tru)]
    #trub = tru[-1]
    #predb = pred[-1]
    #reler[i+1] = reler(predb,trub,bench)
    #print(arsq)
    #pred[i+1] = modt$fitted
    #tru[i+1] = test
    testa[,i+1]=test
    #traina[,i+1] = train
    
    
  }
  #return(data.frame(arsq,WMAPE,rmse,reler))
  #return(data.frame(pred,tru))
  return(testa)
}
```

```{r}
crossvalidtrain <- function(ts,exog,k,h){
  pred = data.frame(ts)
  tru = data.frame(ts)
  testa = data.frame(matrix(data=NA,nrow=length(ts),ncol = k))
  traina = data.frame(matrix(data=NA,nrow=length(ts),ncol = k))
  arsq=0
  WMAPE=0
  rmse=0
  reler=0
  v = as.integer(length(ts)/(2*k))
  size = 2*v
  error = rep(NA,(k-1))
  for (i in (0:(k-1))){
    if (i == 0){z = 0}
    else{z=1}
      if (i == k-1){z2 = 0}
    else{z2=1}
    test = rep(NA,length(ts))
    testx = data.frame(exog)
    for (bb in (1:length(exog))){
      testx[bb] = c(rep(NA,length(exog[,bb])))
    }
    train = ts
    trainx = exog
    test[((size)*i+1):((size)*i+size)] = ts[((size)*i+1):((size)*i+size)]
    for (m in (1:length(testx))){
      testx[((size)*i+1):((size)*i+size),m] = exog[((size)*i+1):((size)*i+size),m]
    }
    train[((size)*i+1-h*z):((size)*i+size+h*z2)] = NA
    for (b in (1:length(trainx))){
      trainx[((size)*i+1-h*z):((size)*i+size+h*z2),b] = NA
    }
    #mod = Arima(train,order = order,xreg = trainx,include.constant = F)
    #modt = Arima(test,model = mod,xreg=testx,include.constant = F)
    #error[i+1] = accuracy(modt)[2]
    #coefnum = sum(order)
    #pred1 = modt$fitted
    #tru1 = test
    #print(length(tsori))
    #print(length(pred1))
    #print(length(tru1))
    #pred = antidiff(tsori,pred1)
    #tru = antidiff(tsori,tru1)
    
    
    
    #plot.ts(pred,col=2)
    #plot.ts(tru,col=4)
    #plot.ts(tru-pred)
    #print(sum(abs(tru),na.rm=T))
    #print(sum(abs(tru-pred),na.rm=T))
    #arsq[i+1] = adjr(pred,tru,coefnum)
    #WMAPE[i+1] = WMAPE(pred,tru)
    #rmse[i+1] = rootMSE(tru,pred)
    #bench = tru[-length(tru)]
    #trub = tru[-1]
    #predb = pred[-1]
    #reler[i+1] = reler(predb,trub,bench)
    #print(arsq)
    #pred[i+1] = modt$fitted
    #tru[i+1] = test
    testa[,i+1]=test
    traina[,i+1] = train
    
    
  }
  #return(data.frame(arsq,WMAPE,rmse,reler))
  #return(data.frame(pred,tru))
  return(traina)
}
```

```{r}
data4 = read.csv("darwinBiochem.csv")
```
```{r}
data42 =data4[-1]
head(data42)
```


```{r}
TEMP = data42[,"TEMP"]
CNDC = data42[,'CNDC']
TURB = data42[,"TURB"]
PAR = data42[,"PAR"]
CPHL = data42[,"CPHL"]
```

```{r}
CNDCmax = max(CNDC,na.rm = T)
CNDCmin = min(CNDC,na.rm = T)
CNDCNorm = (CNDC - CNDCmin)/(CNDCmax-CNDCmin)
```


```{r}
TEMP = (TEMP-min(TEMP,na.rm=T))/(max(TEMP,na.rm=T)-min(TEMP,na.rm=T))
TURB = (TURB-min(TURB,na.rm=T))/(max(TURB,na.rm=T)-min(TURB,na.rm=T))
PAR = (PAR-min(PAR,na.rm=T))/(max(PAR,na.rm=T)-min(PAR,na.rm=T))
CPHL = (CPHL-min(CPHL,na.rm=T))/(max(CPHL,na.rm=T)-min(CPHL,na.rm=T))

```








```{r}
CNDCTestdata = crossvalidtest(CNDCNorm,data.frame(CNDCNorm),5,100)
plot.ts(CNDCTestdata)
```

```{r}
write.csv(CNDCTestdata,file = "CNDCTestdata.csv")
```

```{r}
CNDCTraindata = crossvalidtrain(CNDCNorm,data.frame(CNDCNorm),5,100)
plot.ts(CNDCTraindata[,2])
lines(CNDCTestdata[,2],col=2)
```

```{r}
write.csv(CNDCTraindata,file = "CNDCTraindata.csv")
```


```{r}
crossvalidtrainx <- function(ts,exog,k,h){
  pred = data.frame(ts)
  tru = data.frame(ts)
  testa = data.frame(matrix(data=NA,nrow=length(ts),ncol = k))
  traina = data.frame(matrix(data=NA,nrow=length(ts),ncol = k))
  trainax = data.frame(as.matrix(exog))
  arsq=0
  WMAPE=0
  rmse=0
  reler=0
  v = as.integer(length(ts)/(2*k))
  size = 2*v
  error = rep(NA,(k-1))
  for (i in (0:(k-1))){
    if (i == 0){z = 0}
    else{z=1}
      if (i == k-1){z2 = 0}
    else{z2=1}
    test = rep(NA,length(ts))
    testx = data.frame(exog)
    for (bb in (1:length(exog))){
      testx[bb] = c(rep(NA,length(exog[,bb])))
    }
    train = ts
    trainx = exog
    test[((size)*i+1):((size)*i+size)] = ts[((size)*i+1):((size)*i+size)]
    for (m in (1:length(testx))){
      testx[((size)*i+1):((size)*i+size),m] = exog[((size)*i+1):((size)*i+size),m]
    }
    train[((size)*i+1-h*z):((size)*i+size+h*z2)] = NA
    for (b in (1:length(trainx))){
      trainx[((size)*i+1-h*z):((size)*i+size+h*z2),b] = NA
    }
    #mod = Arima(train,order = order,xreg = trainx,include.constant = F)
    #modt = Arima(test,model = mod,xreg=testx,include.constant = F)
    #error[i+1] = accuracy(modt)[2]
    #coefnum = sum(order)
    #pred1 = modt$fitted
    #tru1 = test
    #print(length(tsori))
    #print(length(pred1))
    #print(length(tru1))
    #pred = antidiff(tsori,pred1)
    #tru = antidiff(tsori,tru1)
    
    
    
    #plot.ts(pred,col=2)
    #plot.ts(tru,col=4)
    #plot.ts(tru-pred)
    #print(sum(abs(tru),na.rm=T))
    #print(sum(abs(tru-pred),na.rm=T))
    #arsq[i+1] = adjr(pred,tru,coefnum)
    #WMAPE[i+1] = WMAPE(pred,tru)
    #rmse[i+1] = rootMSE(tru,pred)
    #bench = tru[-length(tru)]
    #trub = tru[-1]
    #predb = pred[-1]
    #reler[i+1] = reler(predb,trub,bench)
    #print(arsq)
    #pred[i+1] = modt$fitted
    #tru[i+1] = test
    testa[,i+1]=test
    traina[,i+1] = train
    trainax[,i+1] = as.matrix(trainx)
    
  }
  #return(data.frame(arsq,WMAPE,rmse,reler))
  #return(data.frame(pred,tru))
  return(trainax)
}
```


```{r}
crossvalidtestx <- function(ts,exog,k,h){
  pred = data.frame(ts)
  tru = data.frame(ts)
  testa = data.frame(matrix(data=NA,nrow=length(ts),ncol = k))
  traina = data.frame(matrix(data=NA,nrow=length(ts),ncol = k))
  trainax = data.frame(as.matrix(exog))
  testax = data.frame(as.matrix(exog))
  arsq=0
  WMAPE=0
  rmse=0
  reler=0
  v = as.integer(length(ts)/(2*k))
  size = 2*v
  error = rep(NA,(k-1))
  for (i in (0:(k-1))){
    if (i == 0){z = 0}
    else{z=1}
      if (i == k-1){z2 = 0}
    else{z2=1}
    test = rep(NA,length(ts))
    testx = data.frame(exog)
    for (bb in (1:length(exog))){
      testx[bb] = c(rep(NA,length(exog[,bb])))
    }
    train = ts
    trainx = exog
    test[((size)*i+1):((size)*i+size)] = ts[((size)*i+1):((size)*i+size)]
    for (m in (1:length(testx))){
      testx[((size)*i+1):((size)*i+size),m] = exog[((size)*i+1):((size)*i+size),m]
    }
    train[((size)*i+1-h*z):((size)*i+size+h*z2)] = NA
    for (b in (1:length(trainx))){
      trainx[((size)*i+1-h*z):((size)*i+size+h*z2),b] = NA
    }
    #mod = Arima(train,order = order,xreg = trainx,include.constant = F)
    #modt = Arima(test,model = mod,xreg=testx,include.constant = F)
    #error[i+1] = accuracy(modt)[2]
    #coefnum = sum(order)
    #pred1 = modt$fitted
    #tru1 = test
    #print(length(tsori))
    #print(length(pred1))
    #print(length(tru1))
    #pred = antidiff(tsori,pred1)
    #tru = antidiff(tsori,tru1)
    
    
    
    #plot.ts(pred,col=2)
    #plot.ts(tru,col=4)
    #plot.ts(tru-pred)
    #print(sum(abs(tru),na.rm=T))
    #print(sum(abs(tru-pred),na.rm=T))
    #arsq[i+1] = adjr(pred,tru,coefnum)
    #WMAPE[i+1] = WMAPE(pred,tru)
    #rmse[i+1] = rootMSE(tru,pred)
    #bench = tru[-length(tru)]
    #trub = tru[-1]
    #predb = pred[-1]
    #reler[i+1] = reler(predb,trub,bench)
    #print(arsq)
    #pred[i+1] = modt$fitted
    #tru[i+1] = test
    testa[,i+1]=test
    traina[,i+1] = train
    trainax[,i+1] = as.matrix(trainx)
    testax[,i+1] = as.matrix(testx)
  }
  #return(data.frame(arsq,WMAPE,rmse,reler))
  #return(data.frame(pred,tru))
  return(testax)
}
```

```{r}
CNDCTraindataxTEMP = crossvalidtrainx(CNDC,data.frame(TEMP),5,100)
plot.ts(CNDCTraindataxTEMP[,1])
```


```{r}
CNDCTraindataxPAR = crossvalidtrainx(CNDC,data.frame(PAR),5,100)
plot.ts(CNDCTraindataxPAR[,1])
```


```{r}
CNDCTraindataxTURB = crossvalidtrainx(CNDC,data.frame(TURB),5,100)
plot.ts(CNDCTraindataxTURB[,1])
```

```{r}
CNDCTraindataxCPHL = crossvalidtrainx(CNDC,data.frame(CPHL),5,100)
plot.ts(CNDCTraindataxCPHL[,1])
```





```{r}
CNDCtestdataxTURB = crossvalidtestx(CNDC,data.frame(TURB),5,100)
plot.ts(CNDCtestdataxTURB[,1])
```

```{r}
CNDCtestdataxPAR = crossvalidtestx(CNDC,data.frame(PAR),5,100)
plot.ts(CNDCtestdataxPAR[,1])
```

```{r}
CNDCtestdataxCPHL = crossvalidtestx(CNDC,data.frame(CPHL),5,100)
plot.ts(CNDCtestdataxCPHL[,1])
```

```{r}
CNDCtestdataxTEMP = crossvalidtestx(CNDC,data.frame(TEMP),5,100)
plot.ts(CNDCtestdataxTEMP[,1])
```




```{r}
write.csv(CNDCTraindataxTEMP,file = "CNDCTraindataxTEMP.csv")
write.csv(CNDCTraindataxPAR,file = "CNDCTraindataxPAR.csv")
write.csv(CNDCTraindataxTURB,file = "CNDCTraindataxTURB.csv")
write.csv(CNDCTraindataxCPHL,file = "CNDCTraindataxCPHL.csv")

write.csv(CNDCtestdataxTURB,file = "CNDCtestdataxTURB.csv")
write.csv(CNDCtestdataxPAR,file = "CNDCtestdataxPAR.csv")
write.csv(CNDCtestdataxCPHL,file = "CNDCtestdataxCPHL.csv")
write.csv(CNDCtestdataxTEMP,file = "CNDCtestdataxTEMP.csv")
```







WMAPE
REMOVE ABS ON SUM(TRU)
```{r}
WMAPE <- function(pred,tru){
  WMAPE = sum((sum(abs(pred-tru)/tru,na.rm = T)/sum(tru,na.rm = T))*tru,na.rm=T)/length(na.remove(tru))
  return(WMAPE)
}
```


reler
```{r}
reler <- function(pred,tru,bench){
  reler = sum(abs(tru-pred),na.rm = T)/sum(abs(tru-bench),na.rm = T)
  return(reler)
}
```

rsq 
```{r}
rsq <- function(pred,tru){
  SSE = sum((tru-pred)^2,na.rm = T)
  SS = sum((tru-mean(na.omit(tru)))^2,na.rm = T)
  rsq = 1- SSE/SS
  return(rsq)
}
```


adjr
```{r}
adjr <- function(pred,tru,coefnum){
  rs = rsq(pred,tru)
  n = length(pred)
  adjr = 1-(1-rs)*(n-1)/(n-coefnum-1)
  return(adjr)
}
```

rmse
```{r}
rootMSE = function(pred,tru){
  return(sqrt(mean((pred-tru)^2,na.rm = T)))
}
```


```{r}
pred0 = read.csv("CNDC0.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
pred1 = read.csv("CNDC1.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
pred2 = read.csv("CNDC2.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
pred3 = read.csv("CNDC3.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
pred4 = read.csv("CNDC4.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin

tru0 = read.csv("CNDC0tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
tru1 = read.csv("CNDC1tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
tru2 = read.csv("CNDC2tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
tru3 = read.csv("CNDC3tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
tru4 = read.csv("CNDC4tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
```

```{r}
plot.ts(pred0)
lines(tru0,col=2)
plot.ts(pred1)
lines(tru1,col=2)
plot.ts(pred2)
lines(tru2,col=2)
plot.ts(pred3)
lines(tru3,col=2)
plot.ts(pred4)
lines(tru4,col=2)
plot.ts(c(pred0,pred1,pred2,pred3,pred4))
lines(c(tru0,tru1,tru2,tru3,tru4),col=2)
```

```{r}
adjr0 = adjr(pred0,tru0,4)
adjr1 = adjr(pred1,tru1,4)
adjr2 = adjr(pred2,tru2,4)
adjr3 = adjr(pred3,tru3,4)
adjr4 = adjr(pred4,tru4,4)
mean(c(adjr0,adjr1,adjr2,adjr3,adjr4))
sd(c(adjr0,adjr1,adjr2,adjr3,adjr4))

```

```{r}
rootMSE0 = rootMSE(pred0,tru0)
rootMSE1 = rootMSE(pred1,tru1)
rootMSE2 = rootMSE(pred2,tru2)
rootMSE3 = rootMSE(pred3,tru3)
rootMSE4 = rootMSE(pred4,tru4)
mean(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
sd(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
```

```{r}
WMAPE0 = WMAPE(pred0,tru0)
WMAPE1 = WMAPE(pred1,tru1)
WMAPE2 = WMAPE(pred2,tru2)
WMAPE3 = WMAPE(pred3,tru3)
WMAPE4 = WMAPE(pred4,tru4)
mean(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
sd(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
```



```{r}
predTEMP0 = read.csv("CNDCTEMP0.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predTEMP1 = read.csv("CNDCTEMP1.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predTEMP2 = read.csv("CNDCTEMP2.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predTEMP3 = read.csv("CNDCTEMP3.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predTEMP4 = read.csv("CNDCTEMP4.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin

truTEMP0 = read.csv("CNDCTEMP0tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truTEMP1 = read.csv("CNDCTEMP1tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truTEMP2 = read.csv("CNDCTEMP2tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truTEMP3 = read.csv("CNDCTEMP3tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truTEMP4 = read.csv("CNDCTEMP4tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
```

```{r}
plot.ts(predTEMP0)
lines(truTEMP0,col=2)
plot.ts(predTEMP1)
lines(truTEMP1,col=2)
plot.ts(predTEMP2)
lines(truTEMP2,col=2)
plot.ts(predTEMP3)
lines(truTEMP3,col=2)
plot.ts(predTEMP4)
lines(truTEMP4,col=2)
plot.ts(c(predTEMP0,predTEMP1,predTEMP2,predTEMP3,predTEMP4))
lines(c(truTEMP0,truTEMP1,truTEMP2,truTEMP3,truTEMP4),col=2)
```

```{r}
adjr0 = adjr(predTEMP0,truTEMP0,1)
adjr1 = adjr(predTEMP1,truTEMP1,1)
adjr2 = adjr(predTEMP2,truTEMP2,1)
adjr3 = adjr(predTEMP3,truTEMP3,1)
adjr4 = adjr(predTEMP4,truTEMP4,1)
mean(c(adjr0,adjr1,adjr2,adjr3,adjr4))
sd(c(adjr0,adjr1,adjr2,adjr3,adjr4))
```

```{r}
rootMSE0 = rootMSE(predTEMP0,truTEMP0)
rootMSE1 = rootMSE(predTEMP1,truTEMP1)
rootMSE2 = rootMSE(predTEMP2,truTEMP2)
rootMSE3 = rootMSE(predTEMP3,truTEMP3)
rootMSE4 = rootMSE(predTEMP4,truTEMP4)
mean(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
sd(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
```

```{r}
WMAPE0 = WMAPE(predTEMP0,truTEMP0)
WMAPE1 = WMAPE(predTEMP1,truTEMP1)
WMAPE2 = WMAPE(predTEMP2,truTEMP2)
WMAPE3 = WMAPE(predTEMP3,truTEMP3)
WMAPE4 = WMAPE(predTEMP4,truTEMP4)
mean(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
sd(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
```



```{r}
predTURB0 = read.csv("CNDCTURB0.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predTURB1 = read.csv("CNDCTURB1.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predTURB2 = read.csv("CNDCTURB2.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predTURB3 = read.csv("CNDCTURB3.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predTURB4 = read.csv("CNDCTURB4.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin

truTURB0 = read.csv("CNDCTURB0tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truTURB1 = read.csv("CNDCTURB1tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truTURB2 = read.csv("CNDCTURB2tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truTURB3 = read.csv("CNDCTURB3tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truTURB4 = read.csv("CNDCTURB4tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
```

```{r}
plot.ts(predTURB0)
lines(truTURB0,col=2)
plot.ts(predTURB1)
lines(truTURB1,col=2)
plot.ts(predTURB2)
lines(truTURB2,col=2)
plot.ts(predTURB3)
lines(truTURB3,col=2)
plot.ts(predTURB4)
lines(truTURB4,col=2)
plot.ts(c(predTURB0,predTURB1,predTURB2,predTURB3,predTURB4))
lines(c(truTURB0,truTURB1,truTURB2,truTURB3,truTURB4),col=2)
```

```{r}
adjr0 = adjr(predTURB0,truTURB0,1)
adjr1 = adjr(predTURB1,truTURB1,1)
adjr2 = adjr(predTURB2,truTURB2,1)
adjr3 = adjr(predTURB3,truTURB3,1)
adjr4 = adjr(predTURB4,truTURB4,1)
mean(c(adjr0,adjr1,adjr2,adjr3,adjr4))
sd(c(adjr0,adjr1,adjr2,adjr3,adjr4))
```

```{r}
rootMSE0 = rootMSE(predTURB0,truTURB0)
rootMSE1 = rootMSE(predTURB1,truTURB1)
rootMSE2 = rootMSE(predTURB2,truTURB2)
rootMSE3 = rootMSE(predTURB3,truTURB3)
rootMSE4 = rootMSE(predTURB4,truTURB4)
mean(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
sd(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
```

```{r}
WMAPE0 = WMAPE(predTURB0,truTURB0)
WMAPE1 = WMAPE(predTURB1,truTURB1)
WMAPE2 = WMAPE(predTURB2,truTURB2)
WMAPE3 = WMAPE(predTURB3,truTURB3)
WMAPE4 = WMAPE(predTURB4,truTURB4)
mean(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
sd(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
```



```{r}
predPAR0 = read.csv("CNDCPAR0.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predPAR1 = read.csv("CNDCPAR1.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predPAR2 = read.csv("CNDCPAR2.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predPAR3 = read.csv("CNDCPAR3.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predPAR4 = read.csv("CNDCPAR4.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin

truPAR0 = read.csv("CNDCPAR0tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truPAR1 = read.csv("CNDCPAR1tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truPAR2 = read.csv("CNDCPAR2tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truPAR3 = read.csv("CNDCPAR3tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truPAR4 = read.csv("CNDCPAR4tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
```

```{r}
plot.ts(predPAR0)
lines(truPAR0,col=2)
plot.ts(predPAR1)
lines(truPAR1,col=2)
plot.ts(predPAR2)
lines(truPAR2,col=2)
plot.ts(predPAR3)
lines(truPAR3,col=2)
plot.ts(predPAR4)
lines(truPAR4,col=2)
plot.ts(c(predPAR0,predPAR1,predPAR2,predPAR3,predPAR4))
lines(c(truPAR0,truPAR1,truPAR2,truPAR3,truPAR4),col=2)
```

```{r}
adjr0 = adjr(predPAR0,truPAR0,1)
adjr1 = adjr(predPAR1,truPAR1,1)
adjr2 = adjr(predPAR2,truPAR2,1)
adjr3 = adjr(predPAR3,truPAR3,1)
adjr4 = adjr(predPAR4,truPAR4,1)
mean(c(adjr0,adjr1,adjr2,adjr3,adjr4))
sd(c(adjr0,adjr1,adjr2,adjr3,adjr4))
```

```{r}
rootMSE0 = rootMSE(predPAR0,truPAR0)
rootMSE1 = rootMSE(predPAR1,truPAR1)
rootMSE2 = rootMSE(predPAR2,truPAR2)
rootMSE3 = rootMSE(predPAR3,truPAR3)
rootMSE4 = rootMSE(predPAR4,truPAR4)
mean(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
sd(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
```

```{r}
WMAPE0 = WMAPE(predPAR0,truPAR0)
WMAPE1 = WMAPE(predPAR1,truPAR1)
WMAPE2 = WMAPE(predPAR2,truPAR2)
WMAPE3 = WMAPE(predPAR3,truPAR3)
WMAPE4 = WMAPE(predPAR4,truPAR4)
mean(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
sd(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
```




```{r}
predCPHL0 = read.csv("CNDCCPHL0.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predCPHL1 = read.csv("CNDCCPHL1.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predCPHL2 = read.csv("CNDCCPHL2.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predCPHL3 = read.csv("CNDCCPHL3.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
predCPHL4 = read.csv("CNDCCPHL4.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin

truCPHL0 = read.csv("CNDCCPHL0tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truCPHL1 = read.csv("CNDCCPHL1tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truCPHL2 = read.csv("CNDCCPHL2tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truCPHL3 = read.csv("CNDCCPHL3tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
truCPHL4 = read.csv("CNDCCPHL4tru.csv")[,2]*(CNDCmax-CNDCmin) + CNDCmin
```

```{r}
plot.ts(predCPHL0)
lines(truCPHL0,col=2)
plot.ts(predCPHL1)
lines(truCPHL1,col=2)
plot.ts(predCPHL2)
lines(truCPHL2,col=2)
plot.ts(predCPHL3)
lines(truCPHL3,col=2)
plot.ts(predCPHL4)
lines(truCPHL4,col=2)
plot.ts(c(predCPHL0,predCPHL1,predCPHL2,predCPHL3,predCPHL4))
lines(c(truCPHL0,truCPHL1,truCPHL2,truCPHL3,truCPHL4),col=2)
```

```{r}
adjr0 = adjr(predCPHL0,truCPHL0,1)
adjr1 = adjr(predCPHL1,truCPHL1,1)
adjr2 = adjr(predCPHL2,truCPHL2,1)
adjr3 = adjr(predCPHL3,truCPHL3,1)
adjr4 = adjr(predCPHL4,truCPHL4,1)
mean(c(adjr0,adjr1,adjr2,adjr3,adjr4))
sd(c(adjr0,adjr1,adjr2,adjr3,adjr4))
```

```{r}
rootMSE0 = rootMSE(predCPHL0,truCPHL0)
rootMSE1 = rootMSE(predCPHL1,truCPHL1)
rootMSE2 = rootMSE(predCPHL2,truCPHL2)
rootMSE3 = rootMSE(predCPHL3,truCPHL3)
rootMSE4 = rootMSE(predCPHL4,truCPHL4)
mean(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
sd(c(rootMSE0,rootMSE1,rootMSE2,rootMSE3,rootMSE4))
```

```{r}
WMAPE0 = WMAPE(predCPHL0,truCPHL0)
WMAPE1 = WMAPE(predCPHL1,truCPHL1)
WMAPE2 = WMAPE(predCPHL2,truCPHL2)
WMAPE3 = WMAPE(predCPHL3,truCPHL3)
WMAPE4 = WMAPE(predCPHL4,truCPHL4)
mean(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
sd(c(WMAPE0,WMAPE1,WMAPE2,WMAPE3,WMAPE4))
```





















WINDxWINDtrain = pd.concat([WINDTraindata,WINDTraindataxCPHL],axis=1)
WINDxWINDtest = pd.concat([WINDTestdata,WINDtestdataxCPHL],axis=1)
for i in range(0,5):
    WINDdata = WINDxWINDtrain.iloc[:,[i,i*2+5,i*2+6]]
    WINDdata = WINDdata.dropna()
    WINDtrain = WINDdata.iloc[:,0]
    WINDtrainx = WINDdata.iloc[:,[1,2]]
    
    regressorWINDxWIND = MLPRegressor()
    regressorWINDxWIND.fit(WINDtrainx,WINDtrain)
    
    WINDdatatest = WINDxWINDtest.iloc[:,[i,i*2+5,i*2+6]]
    WINDdatatest = WINDdatatest.dropna()
    WINDdatatest = WINDdatatest.reset_index().iloc[:,1:]
    globals()['WINDtestCPHL'+str(i)]  = WINDdatatest.iloc[:,0]
    WINDtest = WINDdatatest.iloc[:,[1,2]]
    globals()['predCPHL'+str(i)] = regressorWINDxWIND.predict(WINDtest)


pred0 = pd.DataFrame(predCPHL0)
pred0.to_csv("WINDCPHL0.csv")
pred1 = pd.DataFrame(predCPHL1)
pred1.to_csv("WINDCPHL1.csv")
pred2 = pd.DataFrame(predCPHL2)
pred2.to_csv("WINDCPHL2.csv")
pred3 = pd.DataFrame(predCPHL3)
pred3.to_csv("WINDCPHL3.csv")
pred4 = pd.DataFrame(predCPHL4)
pred4.to_csv("WINDCPHL4.csv")

WINDtest0 = pd.DataFrame(WINDtestCPHL0)
WINDtest0.to_csv("WINDCPHL0tru.csv")
WINDtest1 = pd.DataFrame(WINDtestCPHL1)
WINDtest1.to_csv("WINDCPHL1tru.csv")
WINDtest2 = pd.DataFrame(WINDtestCPHL2)
WINDtest2.to_csv("WINDCPHL2tru.csv")
WINDtest3 = pd.DataFrame(WINDtestCPHL3)
WINDtest3.to_csv("WINDCPHL3tru.csv")
WINDtest4 = pd.DataFrame(WINDtestCPHL4)
WINDtest4.to_csv("WINDCPHL4tru.csv")












